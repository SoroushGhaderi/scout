2025-12-08 11:43:54,155 - deduplicate_fotmob - INFO - setup_logging:57 - Logging initialized. Log file: logs/deduplicate_fotmob_20251208.log
2025-12-08 11:43:54,170 - deduplicate_fotmob - ERROR - main:137 - Failed to connect to ClickHouse
2025-12-08 11:44:20,763 - deduplicate_fotmob - INFO - setup_logging:57 - Logging initialized. Log file: logs/deduplicate_fotmob_20251208.log
2025-12-08 11:44:20,789 - deduplicate_fotmob - INFO - main:153 - Deduplicating 1 table(s)...
2025-12-08 11:44:20,792 - deduplicate_fotmob - INFO - main:157 - 
================================================================================
2025-12-08 11:44:20,802 - deduplicate_fotmob - INFO - deduplicate_table:62 - Found duplicates in general, deduplicating...
2025-12-08 11:44:20,803 - deduplicate_fotmob - INFO - deduplicate_table:70 - Creating temporary table fotmob.general_temp...
2025-12-08 11:44:20,823 - deduplicate_fotmob - INFO - deduplicate_table:90 - Inserting deduplicated data...
2025-12-08 11:44:20,838 - deduplicate_fotmob - ERROR - deduplicate_table:105 - Failed to deduplicate general: Received ClickHouse exception, code: 20, server response: Code: 20. DB::Exception: Number of columns doesn't match. (NUMBER_OF_COLUMNS_DOESNT_MATCH) (version 23.8.16.16 (official build)) (for url http://clickhouse:8123)
Traceback (most recent call last):
  File "/app/scripts/deduplicate_fotmob_tables.py", line 91, in deduplicate_table
    client.execute(insert_query)
  File "/app/src/storage/clickhouse_client.py", line 151, in execute
    return self.client.query(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/clickhouse_connect/driver/client.py", line 244, in query
    return self._query_with_context(query_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 289, in _query_with_context
    response = self._raw_request(body,
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 549, in _raw_request
    self._error_handler(response)
  File "/opt/venv/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 470, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: Received ClickHouse exception, code: 20, server response: Code: 20. DB::Exception: Number of columns doesn't match. (NUMBER_OF_COLUMNS_DOESNT_MATCH) (version 23.8.16.16 (official build)) (for url http://clickhouse:8123)
2025-12-08 11:44:20,865 - deduplicate_fotmob - INFO - main:161 - 
================================================================================
2025-12-08 11:44:20,867 - deduplicate_fotmob - INFO - main:162 - Deduplication complete: 0/1 tables successful
